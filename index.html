<!DOCTYPE html>
<html lang="es">
<head>
  <!-- (head sin cambios) -->
</head>
<body>
  <!-- (contenido anterior sin cambios) -->

  <!-- Tracking -->
  <section id="seguimiento" class="section">
    <div class="wrap card">
      <h2>Seguimiento</h2>
      <p class="muted">Ingresa tu número de guía y busca el estado de tu envío en nuestro sistema en línea:</p>
      <div class="row">
        <input id="tracking-code" placeholder="Ej: PV12345">
        <button id="btn-track" class="btn alt">Buscar</button>
      </div>
      <div id="tracking-result" style="margin-top:20px;"></div>
    </div>
  </section>

  <!-- (resto sin cambios) -->

  <script>
    // (código anterior sin cambios)

    /* Sistema de tracking usando Google Sheets */
    document.getElementById('btn-track').addEventListener('click', async ()=>{
      const code = document.getElementById('tracking-code').value.trim().toUpperCase();
      const resultBox = document.getElementById('tracking-result');
      resultBox.innerHTML = "<p>Buscando...</p>";

      try {
        const res = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vRhS6Dnh3lb4fmBU-meYbG7lP1Qpg6-5HvsWqI06RdkHTFVkpx2u711X-v6encM-kLX53Wtrl5RSQS1/pub?output=csv');
        const csv = await res.text();
        const rows = csv.split('\n').map(r => r.split(','));
        const headers = rows.shift();
        const idx = headers.indexOf("Guia") >= 0 ? headers.indexOf("Guia") : 0;

        const match = rows.find(r => r[idx].trim().toUpperCase() === code);

        if (match) {
          const details = headers.map((h,i) => `<strong>${h}:</strong> ${match[i]}`).join('<br>');
          resultBox.innerHTML = `<div class="card">${details}</div>`;
        } else {
          resultBox.innerHTML = `<p>No se encontró información para la guía <strong>${code}</strong>.</p>`;
        }
      } catch (err) {
        resultBox.innerHTML = `<p>Error al buscar la guía. Intenta más tarde.</p>`;
      }
    });
  </script>
</body>
</html>
